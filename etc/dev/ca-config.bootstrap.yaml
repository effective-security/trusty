---
profiles:
  default:
    expiry: 168h
    backdate: 30m
    usages:
      - signing
      - key encipherment

  peer:
    issuer_label: L2_CA
    expiry: 168h
    backdate: 30m
    usages:
      - signing
      - key encipherment
      - server auth
      - client auth
      - ipsec user
      - ipsec end system
    allowed_extensions:
      - 1.3.6.1.5.5.7.1.1
      - 2.5.29.17

  server:
    issuer_label: L2_CA
    expiry: 168h
    backdate: 30m
    usages:
      - signing
      - key encipherment
      - server auth
      - ipsec end system
    allowed_extensions:
      - 1.3.6.1.5.5.7.1.1
      - 2.5.29.17

  client:
    issuer_label: L2_CA
    expiry: 168h
    backdate: 30m
    usages:
      - signing
      - key encipherment
      - client auth
      - ipsec user
    allowed_extensions:
      - 1.3.6.1.5.5.7.1.1
      - 2.5.29.17

  ROOT:
    expiry: 43800h
    backdate: 30m
    usages:
      - cert sign
      - crl sign
    ca_constraint:
      is_ca: true
      max_path_len: -1

  L1_CA:
    issuer_label: ROOT
    expiry: 43800h
    backdate: 30m
    usages:
      - cert sign
      - crl sign
    ca_constraint:
      is_ca: true
      max_path_len: 1

  L2_CA:
    issuer_label: L1_CA
    expiry: 43800h
    backdate: 30m
    usages:
      - cert sign
      - crl sign
    ca_constraint:
      is_ca: true
      max_path_len: 0

  SHAKEN_ROOT:
    expiry: 219150h
    backdate: 30m
    # SHAKEN requires EKU to be non critial
    #usages:
    # - cert sign
    # SHAKEN has indirect CDP
    # - crl sign
    extensions:
      - id: 2.5.29.15 # EKU
        critical: false
        value: hex:03020204 # cert sign
    ca_constraint:
      is_ca: true
      max_path_len: -1

  SHAKEN_G1_CA:
    issuer_label: SHAKEN_ROOT
    expiry: 43800h
    backdate: 30m
    # SHAKEN requires EKU to be non critial
    #usages:
    # - cert sign
    # SHAKEN has indirect CDP
    # - crl sign
    extensions:
      - id: 2.5.29.15 # EKU
        critical: false
        value: hex:03020204 # cert sign
    ca_constraint:
      is_ca: true
      max_path_len: 0
    policies_critical: true
    policies:
      - oid: 2.16.840.1.114569.1.1.1
      - oid: 1.3.6.1.4.1.57973.1.1
        qualifiers:
          - type: id-qt-cps
            value: https://stirshaken.com/CPS
    allowed_extensions:
      - 2.5.29.31
      - 2.5.29.32

  DELEGATED_L1_CA:
    issuer_label: SHAKEN_ROOT
    expiry: 43800h
    backdate: 30m
    usages:
      - cert sign
      # TODO: is CRL needed for Delegated?
      - crl sign
    ca_constraint:
      is_ca: true
      max_path_len: 1
    policies_critical: true
    policies:
      - oid: 2.16.840.1.114569.1.1.1
      - oid: 1.3.6.1.4.1.57973.1.1
        qualifiers:
          - type: id-qt-cps
            value: https://stirshaken.com/CPS
    allowed_extensions:
      - 2.5.29.31
      - 2.5.29.32
